<?xml version="1.0" encoding="UTF-8"?>
<!DOCTYPE mapper
   PUBLIC "-//mybatis.org//DTD Mapper 3.0//EN"
   "http://mybatis.org/dtd/mybatis-3-mapper.dtd">
<mapper namespace="com.nds.library.manager.IManagerDAO">

	<select id="MessageList" resultType="com.nds.library.manager.Message">
		SELECT * FROM messages
	</select>

	<select id="requireBookList" parameterType="java.util.Map"
		resultType="com.nds.library.mypage.ReqAndDon">

		select req_don_id, image, title, author, publisher, name,
		TO_CHAR(reqanddon.REGISTERED_DATE,
		'yyyy-mm-dd') AS registered_date,
		current_state, TO_CHAR(finished_date,
		'yyyy-mm-dd') AS finished_date
		from users join reqanddon using(user_id)
		<if test="filter == 0">  <!-- 전체 -->
			where (current_state='신청대기'
			or current_state='신청완료' or
			current_state='구매완료' or current_state='신청반려')
		</if>
		<if test="filter == 1">  <!-- 구매완료 -->
			where current_state='구매완료'
		</if>
		<if test="filter == 2">  <!-- 신청완료 -->
			where current_state='신청완료'
		</if>
		<if test="filter == 3"> <!-- 신청대기 -->
			where current_state='신청대기'
		</if>
		<if test="filter == 4">  <!-- 신청반려 -->
			where current_state='신청반려'
		</if>
		order by reqanddon.REGISTERED_DATE
	</select>

	<select id="getRequireBook" resultType="com.nds.library.mypage.ReqAndDon">
		SELECT * FROM ReqAndDon WHERE req_don_id = #{req_don_id}
	</select>



</mapper>   